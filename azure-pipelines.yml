# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript


trigger:
  branches:
    include:
    - main
    - refs/tags/*
    - releases/tags/*

pr:
- main
- azure-pipeline

pool:
  vmImage: 'ubuntu-latest'

stages:
  - stage: 'InstallOS'
    jobs:
    - job: "InstallOS"
      steps:
        - task: NodeTool@0
          inputs:
            versionSpec: '10.x'
          displayName: 'Install Node.js'
  - stage: 'BuildFrontEnd'
    jobs:
    - template: '.pipeline/job_check_changes.yml'
      parameters:
        path: 'frontend/'
    - template: '.pipeline/enforce_standards.yml'
      parameters:
        path: 'frontend/'
    - job: RefTags
      condition: startsWith(variables['build.sourceBranch'], 'refs/tags/')
      steps:
      - bash: |
        echo "RefTags"
    - job: ReleasesTags
      condition: startsWith(variables['build.sourceBranch'], 'releases/tags/')
      steps:
      - bash: |
        echo "ReleasesTags"        
  - stage: 'BuildBackEnd'
    jobs:
    - template: '.pipeline/job_check_changes.yml'
      parameters:
        path: 'backend/'
    - template: '.pipeline/enforce_standards.yml'
      parameters:
      path: 'frontend/'    
      
        